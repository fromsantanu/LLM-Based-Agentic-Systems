# **Lesson 4: Generating and Running Migrations**

**1. Creating the First Migration Script**

* Once your database models are ready in SQLAlchemy, you can create the initial migration script using the command:

  ```bash
  alembic revision --autogenerate -m "create initial tables"
  ```
* This command scans your SQLAlchemy models and compares them with the current database state.
* It then creates a migration file under the `alembic/versions/` folder.

**2. Understanding Autogenerated vs Manual Migrations**

* **Autogenerated migrations**:
  Alembic automatically detects changes in your models (like new tables, columns, etc.) and writes SQL statements for you.
* **Manual migrations**:
  When Alembic cannot detect a change (like renaming a column or adding a complex constraint), you can manually edit the migration script.
* The migration script contains two functions:

  ```python
  def upgrade():
      # commands to apply changes

  def downgrade():
      # commands to revert changes
  ```

**3. Running Upgrade and Downgrade Commands**

* To apply (upgrade) all pending migrations and update the database schema:

  ```bash
  alembic upgrade head
  ```
* To revert (downgrade) the last migration step:

  ```bash
  alembic downgrade -1
  ```
* You can specify a specific version to upgrade or downgrade to using the version ID from the migration file name.

**âœ… Tip:**
Always review the autogenerated migration file before applying it to ensure that Alembic correctly captured your intended schema changes.

