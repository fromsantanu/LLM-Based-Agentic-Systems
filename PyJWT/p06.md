# **Lesson 6: Best Practices**

When working with JWTs in FastAPI, it‚Äôs important to follow some good habits to keep your system safe and reliable.

### üß© 1. Keep Your Secret Key Safe

The **secret key** is what keeps your tokens secure.
If someone gets your secret key, they can create fake tokens.
So, never write it directly inside your code.

‚úÖ **What to do:**

* Store it in a file named `.env` (environment file).
* Example of `.env` file:

  ```
  SECRET_KEY=myverystrongsecretkey
  ```
* In your FastAPI app, read it using environment variable tools like `python-dotenv` or `pydantic-settings`.

---

### ‚è∞ 2. Token Expiry and Clock Skew

Every token should have a **limited lifetime** ‚Äî it should expire after some time (like 15 or 30 minutes).
This protects your app if a token is stolen.

Sometimes, your computer‚Äôs clock may not match exactly with the server‚Äôs clock (a few seconds difference). This is called **clock skew**.

‚úÖ **What to do:**

* Always include an expiration time (`exp`) in your token.
* When verifying tokens, allow a small margin (a few seconds) for clock differences.

---

### üö´ 3. Don‚Äôt Store Sensitive Information in Tokens

The **payload** part of a JWT can be easily decoded by anyone (it‚Äôs not encrypted, just encoded).

‚úÖ **What to do:**

* Do **not** put private data like passwords or medical records inside tokens.
* Only include basic, necessary info such as:

  ```json
  {
    "sub": "user123",
    "role": "doctor",
    "exp": 1734567890
  }
  ```

---

### üß± 4. Use Pydantic Models for Token Payloads

To make your code clean and prevent mistakes, you can define your token structure using a **Pydantic model**.
This helps you control what goes inside the token and makes your app easier to maintain.

‚úÖ **Example:**

```python
from pydantic import BaseModel
from datetime import datetime

class TokenData(BaseModel):
    sub: str  # user ID or username
    exp: int  # expiration time
    role: str | None = None
```

Now you can easily validate the data when creating or decoding a token.

---

### üß† Summary

| Good Practice                   | Why It‚Äôs Important                      |
| ------------------------------- | --------------------------------------- |
| Use `.env` file                 | Keeps your secret key safe              |
| Add token expiry                | Prevents token misuse                   |
| Allow small clock difference    | Avoids false ‚Äúexpired‚Äù errors           |
| Avoid sensitive info in payload | Protects user privacy                   |
| Use Pydantic models             | Keeps token handling clean and reliable |

---

