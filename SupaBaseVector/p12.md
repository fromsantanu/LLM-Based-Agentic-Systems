# ğŸ“˜ Chapter 12: Using Supabase Vector DB with Python

Now we connect **everything** using **Python**.
Think of Python as the **worker** that talks to Supabase and does the heavy lifting for us.

We will go **step by step**, with **simple explanations**.

---

## 1. What Are We Building in This Chapter?

Using Python, we will:

1. Take some text
2. Convert it into an embedding
3. Insert it into Supabase
4. Search by meaning

All this using **Supabase** and Python.

---

## 2. What You Need Before Starting

You should already have:

* Supabase project (local or cloud)
* `documents` table created
* `match_documents` function ready

You also need:

* Python installed
* Supabase project URL
* Supabase API key

ğŸ“Œ Donâ€™t worry, this is normal setup.

---

## 3. Install Required Python Libraries

We need **two helpers**:

* Supabase Python client â†’ talks to Supabase
* Embedding provider â†’ creates embeddings

### Install using pip

```bash
pip install supabase openai
```

(Simple instruction: â€œPython, please install these tools.â€)

---

## 4. Connecting Python to Supabase

This is like **logging in**.

```python
from supabase import create_client

SUPABASE_URL = "https://your-project-id.supabase.co"
SUPABASE_KEY = "your-api-key"

supabase = create_client(SUPABASE_URL, SUPABASE_KEY)
```

### What this means:

* Python now knows **where** Supabase is
* And **who** it is (API key)

---

## 5. Creating Embeddings in Python

We now convert text into numbers using an AI model, such as **OpenAI**.

### Example Text

```python
text = "Heart disease treatment focuses on lifestyle changes and medication."
```

### Generate Embedding

```python
from openai import OpenAI

client = OpenAI(api_key="your-openai-key")

response = client.embeddings.create(
    model="text-embedding-3-small",
    input=text
)

embedding = response.data[0].embedding
```

ğŸ“Œ Important:

* This embedding length must match your table (e.g., 384)

---

## 6. Inserting Data into Supabase

Now we store:

* Text
* Embedding
* Metadata

```python
supabase.table("documents").insert({
    "content": text,
    "embedding": embedding,
    "metadata": {
        "topic": "cardiology",
        "source": "notes",
        "year": 2024
    }
}).execute()
```

### Plain Meaning:

> â€œPlease store this text, its meaning, and some extra info.â€

---

## 7. Searching by Meaning Using Python

Now comes the **magic part**.

We already created the SQL function `match_documents`.
Python will **call it**.

---

### Step 1: Convert Search Query to Embedding

```python
query = "Cardiac treatment methods"

query_embedding = client.embeddings.create(
    model="text-embedding-3-small",
    input=query
).data[0].embedding
```

---

### Step 2: Call the Vector Search Function

```python
result = supabase.rpc(
    "match_documents",
    {
        "query_embedding": query_embedding,
        "match_count": 5,
        "filter": {"topic": "cardiology"}
    }
).execute()
```

---

### Step 3: Read the Results

```python
for row in result.data:
    print(row["similarity"], row["content"])
```

Higher similarity â†’ better match.

---

## 8. What Is Happening Behind the Scenes?

Python:

* Converts text â†’ numbers

Supabase:

* Compares numbers
* Finds closest meaning
* Returns best matches

You donâ€™t see the math â€” **and you donâ€™t need to**.

---

## 9. Common Python Mistakes (Very Common)

âŒ Wrong API key
âŒ Embedding size mismatch
âŒ Forgetting to call `.execute()`
âŒ Calling wrong function name
âŒ Metadata keys mismatch

ğŸ“Œ Most errors are **small and fixable**.

---

## 10. When Python Is Especially Useful

Python is great for:

* PDF ingestion
* Research databases
* Medical knowledge bases
* Offline preprocessing
* Automation scripts

Many serious Supabase vector projects use Python.

---

## 11. Mental Picture to Remember

ğŸ Python
â¬‡
ğŸ¤– Embeddings
â¬‡
ğŸ—„ Supabase
â¬‡
ğŸ” Meaning-based search

---

## âœ… Chapter 12 Summary

* Python connects easily with Supabase
* AI models create embeddings
* Supabase stores and searches vectors
* `match_documents` keeps code clean
* Python is ideal for backend and automation
* You now have a **working AI search pipeline**

---


