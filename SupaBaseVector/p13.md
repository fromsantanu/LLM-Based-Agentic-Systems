# ğŸ“˜ Chapter 13: Using Supabase Vector DB with JavaScript

In this chapter, we move from **backend Python** to **JavaScript**, which is usually used for:

* Web apps
* Dashboards
* Search boxes
* Chat interfaces

Think of JavaScript as the **front desk** where users interact.

---

## 1. What Are We Building Here?

Using JavaScript, we will:

1. Take user search text
2. Convert it into an embedding
3. Call Supabase vector search
4. Show meaningful results

All powered by **Supabase**.

---

## 2. Where Does JavaScript Run?

JavaScript can run in two places:

### 1ï¸âƒ£ Backend JavaScript (Node.js)

* Safe for API keys
* Best for embeddings
* Recommended for beginners

### 2ï¸âƒ£ Frontend JavaScript (Browser)

* Used for UI
* Should NOT expose secret keys

ğŸ“Œ **Rule to remember**:

> Create embeddings on the **server**, not in the browser.

---

## 3. What You Need Before Starting

Make sure you already have:

* `documents` table
* `match_documents` SQL function
* Supabase project URL
* Supabase **anon** key

---

## 4. Install Supabase JavaScript Client

If you are using Node.js:

```bash
npm install @supabase/supabase-js
```

This is like installing a **telephone** to talk to Supabase.

---

## 5. Connect JavaScript to Supabase

```javascript
import { createClient } from "@supabase/supabase-js";

const supabaseUrl = "https://your-project-id.supabase.co";
const supabaseKey = "your-anon-key";

const supabase = createClient(supabaseUrl, supabaseKey);
```

### Meaning:

* JavaScript now knows **where Supabase is**
* And how to talk to it safely

---

## 6. Creating Embeddings (Backend Only)

Embeddings should be created on the **server**, using an AI model like **OpenAI**.

### Example (Node.js)

```javascript
import OpenAI from "openai";

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});

async function createEmbedding(text) {
  const response = await openai.embeddings.create({
    model: "text-embedding-3-small",
    input: text
  });

  return response.data[0].embedding;
}
```

ğŸ“Œ This keeps your API key **safe**.

---

## 7. Searching Supabase Using JavaScript

Now we call the **vector search function**.

---

### Step 1: Get Query Embedding

```javascript
const query = "Treatment options for heart disease";
const queryEmbedding = await createEmbedding(query);
```

---

### Step 2: Call `match_documents`

```javascript
const { data, error } = await supabase.rpc(
  "match_documents",
  {
    query_embedding: queryEmbedding,
    match_count: 5,
    filter: { topic: "cardiology" }
  }
);

if (error) {
  console.error(error);
}
```

---

### Step 3: Display Results

```javascript
data.forEach(row => {
  console.log(row.similarity, row.content);
});
```

Higher similarity â†’ better match.

---

## 8. How This Fits into a Web App

Typical flow:

1. User types search text
2. Frontend sends text to backend
3. Backend creates embedding
4. Backend calls Supabase
5. Results returned to frontend

ğŸ“Œ The browser never sees:

* Database keys
* AI keys

---

## 9. Common Beginner Mistakes

âŒ Creating embeddings in browser
âŒ Exposing OpenAI API key
âŒ Calling wrong RPC name
âŒ Mismatch in embedding size
âŒ Forgetting metadata filters

These are **very common**â€”donâ€™t worry.

---

## 10. When JavaScript Is the Best Choice

JavaScript is ideal for:

* Search boxes
* AI chat interfaces
* Dashboards
* Knowledge portals
* Student / medical apps

Python prepares data,
JavaScript **serves users**.

---

## 11. Mental Picture to Remember

ğŸ§‘ User
â¬‡
ğŸŒ JavaScript UI
â¬‡
ğŸ§  Backend embedding
â¬‡
ğŸ—„ Supabase vector search

---

## âœ… Chapter 13 Summary

* JavaScript is used for user interaction
* Supabase JS client calls vector search
* Embeddings must be created on backend
* `match_documents` simplifies everything
* JS + Supabase = real AI applications
* Security matters more in JS apps

---


