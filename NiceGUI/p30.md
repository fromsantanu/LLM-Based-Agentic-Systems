## **Lesson 30 — Connecting NiceGUI to FastAPI Endpoints**

### **What you will learn**

In this lesson, you will learn how to make your NiceGUI page talk to a FastAPI backend.
Think of this like a shop counter:

* **NiceGUI** is the front desk where a customer speaks.
* **FastAPI** is the store room where the real work happens.
  You will learn how to send a request from the front desk (NiceGUI) to the store room (FastAPI) and bring back a result.

---

## **1. Why this is useful (simple example)**

Imagine you type a number on a NiceGUI page and want the server to double it.
NiceGUI alone cannot do the calculation — so it sends the number to FastAPI, FastAPI doubles it, and sends the answer back.

This simple idea is used everywhere:

* Submit a form → save data in a database
* Ask a chatbot → get a reply
* Show a dashboard → fetch today’s stats

---

## **2. Step-by-step plan**

1. Create a small FastAPI service that has one endpoint `/double`.
2. The endpoint receives a number and returns the doubled number.
3. Create a NiceGUI page with:

   * a text box
   * a button
   * a place to show the result
4. When the button is clicked, NiceGUI calls the FastAPI endpoint and displays the reply.

---

## **3. FastAPI Code (backend)**

Save this file as **`api_app.py`**.

```python
from fastapi import FastAPI

app = FastAPI()

@app.get('/double')
def double_number(x: int):
    return {"result": x * 2}
```

### **Explanation in simple words**

* `FastAPI()` starts the backend service.
* `/double` is the address we call.
* It receives a number `x` and sends back `"result": x*2`.

Run this backend first:

```
uvicorn api_app:app --reload --port 8001
```

---

## **4. NiceGUI Code (frontend)**

Save this file as **`main.py`**.

```python
from nicegui import ui
import requests

def call_backend():
    number = input_box.value
    response = requests.get("http://localhost:8001/double", params={"x": number})
    result_label.set_text(f"Result: {response.json()['result']}")

ui.label("Enter a number:")
input_box = ui.input()

ui.button("Double It", on_click=call_backend)

result_label = ui.label("Result: ")

ui.run()
```

---

## **5. Line-by-line explanation**

* `requests` is used to send a message to FastAPI (like delivering a letter).
* `input_box.value` reads the number typed by the user.
* `requests.get(...)` calls FastAPI at `http://localhost:8001/double`.
* `params={"x": number}` sends the number to the backend.
* `response.json()` reads the reply.
* `result_label.set_text(...)` shows the result on the page.

---

## **6. How to run and test**

1. Open a terminal → run FastAPI:

   ```
   uvicorn api_app:app --reload --port 8001
   ```

2. Open another terminal → run NiceGUI:

   ```
   python main.py
   ```

3. Visit **[http://localhost:8080](http://localhost:8080)**

4. Type a number → click **Double It**

5. You should see something like:

```
Result: 20
```

---

## **7. Tips & Best Practices**

### **Tip 1: Keep backend and frontend separate**

Think of them as two rooms in your house.
If one has a problem, the other still works.

### **Tip 2: Always test the backend using a browser first**

Try visiting:

```
http://localhost:8001/double?x=5
```

If you see `{ "result": 10 }`, then your backend is healthy.

---

