# **Lesson 34 — Role-Based Dashboards

(doctor vs patient vs admin)**

---

### **1. What you will learn**

In this lesson, you will learn how to show **different dashboards** depending on who logs in.

For example:

* **Doctor** sees: patient list, visit history, diagnosis tools
* **Patient** sees: prescriptions, reports, upcoming visits
* **Admin** sees: user management, clinic statistics, settings

This idea is called **Role-Based Access**.
Think of it like different people having **different keys** to the same building.

---

### **2. Simple real-life example**

Imagine a hospital:

* A **doctor** can enter examination rooms
* A **patient** can enter waiting area + pharmacy
* An **admin** can go everywhere

Everyone uses the **same entrance**, but once inside, they are allowed to see **different areas** based on their role.

Your NiceGUI app will work exactly like this.

---

### **3. Step-by-step plan**

1. Add **roles** to the user database
2. After login, save:

   * username
   * role
   * logged_in status
3. Based on role, show the correct dashboard:

   * doctor_dashboard
   * patient_dashboard
   * admin_dashboard
4. Provide a Logout button
5. Prevent switching dashboards without logging in

---

### **4. Code Example — Role-Based Dashboards**

Save as **`main.py`**.

```python
from nicegui import ui, app

# Simple fake user database
USERS = {
    'doctor1': {'password': 'doc123', 'role': 'doctor'},
    'patient1': {'password': 'pat123', 'role': 'patient'},
    'admin1':   {'password': 'admin123', 'role': 'admin'},
}

def init_session():
    app.storage.user.setdefault('logged_in', False)
    app.storage.user.setdefault('username', '')
    app.storage.user.setdefault('role', '')

def show_dashboard():
    """Choose dashboard based on role."""
    role = app.storage.user['role']

    dashboard_column.clear()

    if not app.storage.user['logged_in']:
        dashboard_column.clear()
        ui.label('Please log in first', parent=dashboard_column)
        return

    if role == 'doctor':
        doctor_dashboard()
    elif role == 'patient':
        patient_dashboard()
    elif role == 'admin':
        admin_dashboard()

def doctor_dashboard():
    with dashboard_column:
        ui.label('Doctor Dashboard').classes('text-h5')
        ui.label('• View patient list')
        ui.label('• Check visit history')
        ui.label('• Start diagnosis chat')

def patient_dashboard():
    with dashboard_column:
        ui.label('Patient Dashboard').classes('text-h5')
        ui.label('• View prescriptions')
        ui.label('• Check lab reports')
        ui.label('• Upcoming appointments')

def admin_dashboard():
    with dashboard_column:
        ui.label('Admin Dashboard').classes('text-h5')
        ui.label('• Manage users')
        ui.label('• Check clinic stats')
        ui.label('• System settings')

def handle_login():
    username = username_input.value.strip()
    password = password_input.value

    if username in USERS and USERS[username]['password'] == password:
        app.storage.user['logged_in'] = True
        app.storage.user['username'] = username
        app.storage.user['role'] = USERS[username]['role']

        ui.notify(f"Logged in as {username} ({app.storage.user['role']})", type='positive')

        password_input.value = ''
        show_dashboard()
    else:
        ui.notify('Invalid login', type='negative')

def handle_logout():
    app.storage.user['logged_in'] = False
    app.storage.user['username'] = ''
    app.storage.user['role'] = ''

    dashboard_column.clear()
    ui.notify('Logged out', type='warning')

# -------------------- UI Layout --------------------

init_session()

ui.label('Role-based Login').classes('text-h5')

with ui.card():
    username_input = ui.input('Username')
    password_input = ui.input('Password', password=True, password_toggle_button=True)

    with ui.row():
        ui.button('Login', on_click=handle_login)
        ui.button('Logout', on_click=handle_logout)

ui.separator()

ui.label('Dashboard Area:')

# This is the area we switch based on role
with ui.column() as dashboard_column:
    ui.label('Please log in to see your dashboard.')

ui.run()
```

---

### **5. Explanation in simple words**

#### **Fake user database**

```python
USERS = {
    'doctor1': {'password': 'doc123', 'role': 'doctor'},
    'patient1': {'password': 'pat123', 'role': 'patient'},
    'admin1':   {'password': 'admin123', 'role': 'admin'},
}
```

* Each user has:

  * username → `doctor1`
  * password → `doc123`
  * role → doctor/patient/admin

This helps us decide which dashboard to show.

---

### **Session storage**

```python
app.storage.user['logged_in']
app.storage.user['username']
app.storage.user['role']
```

Each browser keeps its own login and role info.

---

### **show_dashboard()**

This function decides what to show:

```python
if role == 'doctor':
    doctor_dashboard()
```

Same for patient and admin.

---

### **doctor_dashboard(), patient_dashboard(), admin_dashboard()**

Each function prints different labels:

```
Doctor Dashboard:
• View patient list
• Check visit history
• Start diagnosis chat
```

You can later replace these with real pages.

---

### **Dashboard Column**

```python
with ui.column() as dashboard_column:
```

This is a **placeholder** area.
Every time someone logs in, we **clear** it and refill with correct content.

---

### **Login + Logout**

* Login:

  * checks username & password
  * stores role
  * loads the dashboard

* Logout:

  * clears session data
  * clears dashboard area

---

### **6. How to run and test**

1. Save the file as **`main.py`**

2. Run:

   ```bash
   python main.py
   ```

3. Open browser:

   ```
   http://localhost:8080
   ```

---

### **Test each role**

#### **Doctor**

* username: `doctor1`
* password: `doc123`

You should see:

```
Doctor Dashboard
• View patient list
• Check visit history
• Start diagnosis chat
```

#### **Patient**

* username: `patient1`
* password: `pat123`

You should see:

```
Patient Dashboard
• View prescriptions
• Check lab reports
• Upcoming appointments
```

#### **Admin**

* username: `admin1`
* password: `admin123`

You should see:

```
Admin Dashboard
• Manage users
• Check clinic stats
• System settings
```

Each user sees a different screen — exactly like a real clinic app.

---

### **7. Tips & Best Practices**

#### **Tip 1: Never trust frontend for security**

Even if you hide buttons on the page,
your **backend** should still protect admin-only APIs.

#### **Tip 2: Roles should come from a database**

Later, move roles into real tables:

```
users
roles
permissions
```

#### **Tip 3: Keep dashboards simple**

Start with labels, then slowly add:

* Buttons
* Tables
* Charts
* Links to other pages

---


