# **Lesson 6: Adding Scrolling Chat History**

In this lesson, youâ€™ll make your chat window smart enough to handle **many messages**.

Right now, if the user chats a lot, the messages will just keep growing down the page.
We want the chat area to act like **WhatsApp or Messenger**:

* messages stay inside a fixed box
* when there are many messages, a **scroll bar** appears
* the user can scroll up to see older messages

---

## ğŸ§  Real-life example

Think of a **notice board**:

* The board size is fixed.
* If you keep pinning new papers, old ones move up.
* You can move your eyes (or a step ladder!) to see older notes.

Our chat window will work like that â€” a fixed-size box where you can **scroll** to see older messages.

---

## ğŸ§© What weâ€™ll do in this lesson

1. Create a **fixed-height chat box**.
2. Make it **scrollable** when there are many messages.
3. Keep adding new messages to the chat history.

Weâ€™ll reuse the idea from Lesson 5 but adjust the layout a bit.

---

# ğŸ’» Code: Chat Window with Scrolling History

Save this file as: **chat_scroll.py**

```python
from nicegui import ui

# store all chat messages here
messages = []

def send_message():
    user_text = input_box.value

    # do nothing if user typed only spaces or left it empty
    if not user_text.strip():
        return

    # add user's message
    messages.append(f"You: {user_text}")

    # make a simple bot reply
    bot_reply = f"Bot: I received '{user_text}'"
    messages.append(bot_reply)

    # clear the chat area and show all messages again
    chat_area.clear()
    for msg in messages:
        ui.label(msg, parent=chat_area)

    # clear the input box for next message
    input_box.value = ""

with ui.column().classes('w-1/2 q-pa-md'):
    ui.label('Chat with Scrolling History').classes('text-h5')

    # chat area with fixed height and scroll enabled
    chat_area = ui.column().classes(
        'border rounded p-4 h-64 overflow-y-auto bg-white'
    )

    # input row: text box + send button
    with ui.row().classes('w-full items-center q-pt-md'):
        input_box = ui.input(
            placeholder='Type your message here...'
        ).classes('w-full')
        ui.button('Send', on_click=send_message)

ui.run()
```

---

# ğŸ§¾ Line-by-Line Explanation

### `from nicegui import ui`

We import NiceGUI so we can create the user interface.

---

### `messages = []`

This list stores **all chat messages** (like a history).
Each time someone sends a message, we add it here.

---

### `def send_message():`

This function runs when the user clicks the **Send** button.

---

### `user_text = input_box.value`

We read whatever the user typed in the input box.

---

### `if not user_text.strip():`

This checks if the user typed something meaningful.
If itâ€™s empty or just spaces, we **do nothing**.

---

### `messages.append(f"You: {user_text}")`

We add a line like:
`You: Hello`
to the message list.

---

### `bot_reply = f"Bot: I received '{user_text}'"`

We create a simple fake reply.
Later, you can replace this with a real API call.

---

### `messages.append(bot_reply)`

We add the botâ€™s reply to the history.

---

### `chat_area.clear()`

We remove all old message labels from the chat display area.
(Donâ€™t worry: the actual text is **still in** the `messages` list.)

---

### `for msg in messages: ui.label(msg, parent=chat_area)`

We loop through every stored message and show it again in the chat area.
Now the chat area shows the **full conversation**.

---

### `input_box.value = ""`

We empty the input box so the user can type the next message.

---

### `with ui.column().classes('w-1/2 q-pa-md'):`

We create a vertical layout (one thing under another) and give it:

* `w-1/2` â†’ half screen width
* `q-pa-md` â†’ some padding (space inside)

---

### `ui.label('Chat with Scrolling History').classes('text-h5')`

We add a title at the top: **Chat with Scrolling History**.

---

### `chat_area = ui.column().classes('border rounded p-4 h-64 overflow-y-auto bg-white')`

This is the **most important part** for scrolling:

* `border` â†’ adds a border around the chat box
* `rounded` â†’ makes corners a bit curved
* `p-4` â†’ adds padding inside the box
* `h-64` â†’ sets a fixed height
* `overflow-y-auto` â†’ if messages are more than height, show vertical scroll bar
* `bg-white` â†’ white background

So this becomes a **fixed-size box** that scrolls when there are many messages.

---

### `with ui.row().classes('w-full items-center q-pt-md'):`

We create a row for the input and the button, side by side.

* `w-full` â†’ full width
* `items-center` â†’ vertically align center
* `q-pt-md` â†’ top padding (some space above)

---

### `input_box = ui.input(...).classes('w-full')`

This is where the user types messages.

* `placeholder='Type your message here...'` â†’ faint text inside the input
* `w-full` â†’ take all available horizontal space in the row

---

### `ui.button('Send', on_click=send_message)`

The **Send** button.
When clicked, it runs the `send_message` function.

---

# â–¶ï¸ How to Run and Test

1. Save the code as: **`chat_scroll.py`**

2. Open your **terminal / command prompt**.

3. Go to the folder where you saved the file.

4. Run:

   ```bash
   python chat_scroll.py
   ```

5. Open your browser and visit:

   ```
   http://localhost:8080
   ```

6. Type several messages and press **Send** each time.

After many messages:

* You will see the chat box stays the same size.
* A **scroll bar** appears on the right.
* You can scroll up to see older messages.

---

# ğŸ’¡ Tips & Best Practices

### âœ… Tip 1: Test with many messages

Type 15â€“20 short messages like:

* Hi
* How are you?
* Tell me a joke
* Another message
* And so on...

Youâ€™ll clearly see the scroll bar and how the chat box behaves.

---

### âœ… Tip 2: Separate â€œlogicâ€ and â€œlayoutâ€ in your mind

* **Logic** â†’ What happens when you click send? (we used `send_message`)
* **Layout** â†’ How things look and where they appear? (we used `ui.column`, `ui.row`, and `.classes(...)`)

Thinking this way will help a lot as apps become bigger.

---


