### Lesson 44: Deploying NiceGUI with uvicorn + FastAPI

In this lesson you’ll learn how to **run a NiceGUI app and FastAPI backend together** using **uvicorn**.

Think of it like this:

* **FastAPI** = your backend kitchen (cooks data / APIs)
* **NiceGUI** = your front desk and dining area (buttons, forms, pages)
* **uvicorn** = the waiter/server (actually serves everything to the browser)

We’ll put all three in **one simple project**.

---

## 1. What we will build

A small app where:

* `/` → shows a **NiceGUI page** with a button
* `/api/hello` → is a **FastAPI JSON API**
* Both are served by **uvicorn** from the **same app**

---

## 2. Install the required packages

In a new folder, open a terminal and run:

```bash
pip install nicegui fastapi "uvicorn[standard]"
```

This gives you:

* `nicegui` → for UI
* `fastapi` → for API routes
* `uvicorn` → to run the server

---

## 3. Create `main.py`

Create a file called `main.py` and put this code inside:

```python
from fastapi import FastAPI
from nicegui import ui

# 1) Create a FastAPI app (backend)
app = FastAPI()


# 2) A simple FastAPI API endpoint
@app.get('/api/hello')
def hello():
    return {'message': 'Hello from FastAPI!'}


# 3) A NiceGUI page for the browser
@ui.page('/')
def index_page():
    ui.label('Hello from NiceGUI + FastAPI!')
    ui.button('Click me', on_click=lambda: ui.notify('Button clicked'))


# 4) Attach NiceGUI to the FastAPI app
ui.run_with(
    app,                 # use our FastAPI app
    title='NiceGUI + FastAPI demo',  # browser tab title
)
```

### Line-by-line explanation

* `from fastapi import FastAPI`
  We import FastAPI so we can create an API application.

* `from nicegui import ui`
  We import NiceGUI’s `ui` to build pages and components.

* `app = FastAPI()`
  This creates the **main FastAPI app**.

* `@app.get('/api/hello')`
  This defines a **GET** API endpoint at `/api/hello`.

* `def hello(): return {'message': 'Hello from FastAPI!'}`
  When someone visits `/api/hello`, they get this JSON response.

* `@ui.page('/')`
  This tells NiceGUI: “Create a web page for the path `/`.”

* Inside `index_page()`:

  * `ui.label('Hello from NiceGUI + FastAPI!')`
    Shows a text label.
  * `ui.button('Click me', on_click=...)`
    Adds a button that, when clicked, shows a popup notification.

* `ui.run_with(app, title='NiceGUI + FastAPI demo')`
  This is the key part: we **attach NiceGUI to the existing FastAPI app** so both share the same server and can be run with uvicorn. ([Reddit][1])

---

## 4. Run with uvicorn

In the same folder as `main.py`, run:

```bash
uvicorn main:app --reload
```

Explanation:

* `main` → the filename `main.py` (without `.py`)
* `app` → the FastAPI object we created (`app = FastAPI()`)
* `--reload` → automatically restarts the server when you change the code (good for development)

If everything is fine, the terminal will show something like:

* `Uvicorn running on http://127.0.0.1:8000`

---

## 5. Test in the browser

Open these in your browser:

1. **NiceGUI page**:
   `http://127.0.0.1:8000/`

   * You should see the label and the button.
   * Click the button → a small NiceGUI notification should appear.

2. **FastAPI API**:
   `http://127.0.0.1:8000/api/hello`

   * You should see JSON like:

     ```json
     {"message": "Hello from FastAPI!"}
     ```

3. **FastAPI docs** (auto-generated):
   `http://127.0.0.1:8000/docs`

   * This shows Swagger UI where you can test `/api/hello`.

---

## 6. Alternative: Start uvicorn from Python (optional)

Instead of running uvicorn from the terminal, you can start it inside the Python file:

```python
from fastapi import FastAPI
from nicegui import ui
import uvicorn

app = FastAPI()


@app.get('/api/hello')
def hello():
    return {'message': 'Hello from FastAPI!'}


@ui.page('/')
def index_page():
    ui.label('Hello from NiceGUI + FastAPI!')
    ui.button('Click me', on_click=lambda: ui.notify('Button clicked'))


ui.run_with(app, title='NiceGUI + FastAPI demo')


if __name__ == '__main__':
    uvicorn.run('main:app', host='0.0.0.0', port=8000, reload=True)
```

Now you can start the app with:

```bash
python main.py
```

---

## 7. How this fits into a real project

In a bigger project you can:

* Add more FastAPI routes: `/api/patients`, `/api/diagnosis`, etc.
* Use NiceGUI pages as dashboards, forms, chat UIs, etc.
* Still run **everything from one uvicorn command**.

---

## 8. Tips & best practices

1. **For development**
   Use:

   ```bash
   uvicorn main:app --reload
   ```

   This is easier while you’re changing code frequently.

2. **For production**

   * Remove `--reload`.
   * Use `host=0.0.0.0` and a proper process manager (like systemd, Docker, etc.).
   * You can also put nginx or another reverse proxy in front if needed.

---


