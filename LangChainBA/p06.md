# 6. Tools & Agents

LangChain becomes powerful when you connect **LLMs** with **external tools** and orchestrate them through **agents**. This chapter explains what tools and agents are, how to use them, and shows examples with common toolkits.

---

## Tools

### What are Tools in LangChain?

* A **Tool** is a wrapper around an external capability (API, function, or code).
* Tools extend the LLM’s capabilities beyond text generation.
* Examples:

  * **Google Search** → fetches real-time web data.
  * **SQL Database** → queries structured data.
  * **Python REPL** → executes code dynamically.

In essence, tools act as **API endpoints** that the agent can call.

---

### Writing Custom Tools

You can create your own tool in LangChain with a Python function.

```python
from langchain.tools import tool

@tool
def add_numbers(x: int, y: int) -> int:
    """Add two numbers and return the result."""
    return x + y

# Use tool
print(add_numbers.run({"x": 3, "y": 5}))
# Output: 8
```

Key points:

* Use the `@tool` decorator.
* Provide a clear **docstring** (agents use this description to know when to call the tool).
* Tools can wrap APIs, DB queries, ML models, or your own functions.

---

## Agents

### What are Agents?

* An **Agent** is a controller that decides:

  1. Whether to use a tool.
  2. Which tool to call.
  3. What input to pass.
* It uses **reasoning steps** (ReAct framework: *Reasoning + Acting*) to dynamically decide how to solve tasks.

---

### Zero-Shot ReAct Agent

* Works without prior examples.
* Uses the ReAct framework: the LLM reasons about the task, selects a tool, executes, observes output, and continues until it produces the final answer.

```python
from langchain.agents import initialize_agent, AgentType
from langchain.tools import Tool
from langchain_openai import ChatOpenAI

# Define a sample tool
def multiply_numbers(x: int, y: int) -> int:
    return x * y

tools = [
    Tool(
        name="Multiply Numbers",
        func=multiply_numbers,
        description="Multiplies two numbers"
    )
]

llm = ChatOpenAI(model="gpt-4o-mini")
agent = initialize_agent(tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION)

response = agent.run("Multiply 6 and 7")
print(response)
# Output: 42
```

---

### Conversational Agent

* Maintains **conversation history** while using tools.
* Best for **chatbots** that need memory and tool use.

```python
from langchain.agents import AgentType

conv_agent = initialize_agent(tools, llm, agent=AgentType.CONVERSATIONAL_REACT_DESCRIPTION, verbose=True)
print(conv_agent.run("Multiply 9 and 3"))
```

---

### Structured Chat Agent

* Requires **structured tool inputs/outputs** (strict schema).
* Useful when tools expect **JSON-like arguments**.

```python
agent = initialize_agent(
    tools, 
    llm, 
    agent=AgentType.STRUCTURED_CHAT_ZERO_SHOT_REACT_DESCRIPTION, 
    verbose=True
)
```

---

## Toolkits

LangChain provides **pre-built toolkits** that bundle common tools.

### Google Search Toolkit

* Allows the agent to query the internet.
* Example: `GoogleSerperAPIWrapper` (needs API key).

```python
from langchain.utilities import SerpAPIWrapper
from langchain.agents import load_tools

search = SerpAPIWrapper()
tools = load_tools(["serpapi"], llm=llm)
```

---

### SQL Database Toolkit

* Lets the agent **query databases with natural language**.

```python
from langchain.sql_database import SQLDatabase
from langchain.agents import create_sql_agent

db = SQLDatabase.from_uri("sqlite:///mydb.db")
sql_agent = create_sql_agent(llm, db=db, verbose=True)

sql_agent.run("How many users are in the database?")
```

---

### Python REPL Toolkit

* Gives the agent a **Python execution environment**.
* Useful for data analysis, plotting, and math.

```python
from langchain.agents import load_tools

tools = load_tools(["python_repl"], llm=llm)
agent = initialize_agent(tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION)

agent.run("Calculate the square root of 256 using Python")
```

---

## Example: Building a Calculator Agent

```python
from langchain_openai import ChatOpenAI
from langchain.tools import Tool
from langchain.agents import initialize_agent, AgentType

# Tools
def add(x: int, y: int) -> int:
    return x + y

def subtract(x: int, y: int) -> int:
    return x - y

tools = [
    Tool(name="Addition", func=add, description="Adds two numbers"),
    Tool(name="Subtraction", func=subtract, description="Subtracts y from x"),
]

# LLM
llm = ChatOpenAI(model="gpt-4o-mini")

# Agent
agent = initialize_agent(tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION, verbose=True)

# Query
print(agent.run("What is 50 minus 18 plus 7?"))
```

---

✅ **Summary of this chapter:**

* Tools extend LLM abilities (APIs, databases, Python code).
* Agents decide dynamically how to use tools.
* Types: **Zero-Shot ReAct, Conversational, Structured Chat**.
* Toolkits: **Google Search, SQL, Python REPL**.
* Example shown: building a calculator agent.

---

