# ğŸ“˜ Chapter 12: Supabase Storage

### *(Files, buckets, and secure access)*

So far, we worked with **data in tables** (text, numbers, JSON).
But real applications also need **files**:

* Images
* PDFs
* Audio
* Videos
* Reports

That is where **Supabase Storage** comes in.

---

## 1ï¸âƒ£ What is Supabase Storage?

Supabase Storage is a **file storage system** built into **Supabase**.

It lets you:

* Upload files
* Organize them
* Control who can access them
* Link files to database records

ğŸ“Œ Simple idea:

> **Database = structured data
> Storage = actual files**

---

## 2ï¸âƒ£ Buckets (Very Important Concept)

A **bucket** is like a **folder**.

ğŸ“Œ Examples of buckets:

* `profile-photos`
* `documents`
* `medical-reports`
* `public-images`

Each bucket:

* Holds many files
* Has its own access rules

ğŸ“Œ Real-life analogy
A bucket is like a **store room**:

* You decide who can enter
* You decide what is kept inside

---

## 3ï¸âƒ£ Public vs Private Buckets

This is the **most important decision** in Storage.

---

### ğŸŒ Public Bucket

*(Anyone can view files)*

* Files can be accessed by URL
* No login required
* Good for:

  * Profile pictures
  * Public images
  * Website assets

ğŸ“Œ Analogy:

* Notice board outside an office
* Anyone can see it

âš ï¸ Use carefully
Never store sensitive files here.

---

### ğŸ”’ Private Bucket

*(Access controlled)*

* Login required
* Access controlled by policies
* Good for:

  * PDFs
  * Medical records
  * Personal documents

ğŸ“Œ Analogy:

* Locked cabinet
* Only authorized people get the key

ğŸ‘‰ Most serious applications use **private buckets**.

---

## 4ï¸âƒ£ How Storage Security Works

Supabase Storage security works just like database security:

* Authentication identifies the user
* Policies decide access

Under the hood, Storage policies are also enforced using **PostgreSQL**.

ğŸ“Œ Important idea:

> **Storage is not â€œoutsideâ€ the database system
> It follows the same security philosophy**

---

## 5ï¸âƒ£ Uploading Files (Conceptual Flow)

When a user uploads a file:

1. User logs in
2. App sends file to Supabase Storage
3. Supabase checks:

   * Is user authenticated?
   * Does policy allow upload?
4. File is stored in a bucket
5. File path is returned

ğŸ“Œ Usually, you then:

* Save the file path in a database table
* Link it to a user or record

---

## 6ï¸âƒ£ Linking Files with Database Records (Best Practice)

Very important rule:

> **Never rely only on file names**

Instead:

* Upload file
* Store its path in a table

### Example:

Table: `documents`

| column     | meaning      |
| ---------- | ------------ |
| id         | document id  |
| user_id    | owner        |
| file_path  | storage path |
| created_at | timestamp    |

ğŸ“Œ This allows:

* Ownership control
* Easy cleanup
* Clear relationships

---

## 7ï¸âƒ£ Downloading Files Safely

### Public bucket

* File opens directly by URL

### Private bucket

* Requires:

  * Login
  * Permission
* Often uses **temporary access links**

ğŸ“Œ Analogy:

* Visitor pass that expires after some time

This protects:

* Sensitive files
* Private documents

---

## 8ï¸âƒ£ Common Use Cases

Supabase Storage is commonly used for:

* Profile photos
* PDFs and reports
* Research papers
* Medical documents
* Audio recordings
* AI-related files (prompts, outputs)

ğŸ“Œ Storage + Database together form a **complete system**.

---

## 9ï¸âƒ£ Common Beginner Mistakes (Avoid These)

âŒ Putting private files in public buckets
âŒ Not linking files to database records
âŒ Allowing uploads without authentication
âŒ Forgetting cleanup when records are deleted

ğŸ‘‰ Storage without rules becomes a **security risk**.

---

## ğŸ”Ÿ Simple Design Rules (Follow These)

* Use **public buckets only for public files**
* Use **private buckets for user data**
* Always store file paths in tables
* Always connect files to users
* Test access with different users

---

## âœ… Key Takeaways

* Supabase Storage handles files
* Buckets are folders
* Public â‰  Private (choose carefully)
* Storage follows same security model as database
* Best practice = Storage + Table + RLS

---

### ğŸ”œ Chapter 13 Preview

Next chapter we will cover:

* Supabase Edge Functions
* Server-side logic without managing servers
* When to use functions vs backend tools
* Simple real-life examples


