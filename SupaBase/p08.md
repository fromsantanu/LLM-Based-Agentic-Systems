# ğŸ“˜ Chapter 8: Row Level Security (RLS)

### *(The most important security concept in Supabase)*

Many beginners feel **confused or blocked** at this stage.
Thatâ€™s normal. Once RLS is clear, **Supabase suddenly makes sense**.

---

## 1ï¸âƒ£ What is Row Level Security (RLS)?

**Row Level Security decides:**

* **Which rows** of a table a user can see
* **Which rows** a user can insert, update, or delete

Supabase uses **PostgreSQL**â€™s built-in security feature called **RLS**.

ğŸ‘‰ Simple idea:

> **Login tells who you are
> RLS decides what you can do**

---

## 2ï¸âƒ£ Why Supabase Blocks Data by Default

When you create a table:

* You may be logged in
* You may have data in the table
* **Still, Supabase returns nothing**

ğŸ“Œ This is **intentional**.

Supabase follows **secure-by-default** design:

* No data is exposed unless you **explicitly allow it**

ğŸ“Œ Real-life analogy

* You enter a building
* Doors are locked by default
* You need permission to open each room

---

## 3ï¸âƒ£ Authentication vs RLS (Clear Difference)

### ğŸ” Authentication

* Confirms identity
* â€œYes, this is user Xâ€

### ğŸ›¡ï¸ Authorization (RLS)

* Controls access
* â€œUser X can read only these rowsâ€

ğŸ‘‰ Supabase **separates** these two on purpose.

---

## 4ï¸âƒ£ The Core RLS Rule (Very Important)

Most Supabase apps follow this simple rule:

> **A user can access only rows that belong to them**

That means:

* Table rows must contain a `user_id`
* That `user_id` must match the logged-in user

ğŸ“Œ This is why **Chapter 7 (Auth)** was important.

---

## 5ï¸âƒ£ Enabling RLS on a Table

RLS is **off by default** for new tables.

To enable it:

* Open **Table Editor**
* Select the table
* Turn **Row Level Security ON**

ğŸ“Œ Turning RLS ON is like:

* Locking all doors
* Then deciding who gets which key

---

## 6ï¸âƒ£ Your First Simple RLS Policy (Read Own Data)

### Example table: `profiles`

| column | meaning                   |
| ------ | ------------------------- |
| id     | user id (from auth.users) |
| name   | profile name              |

### Policy idea:

ğŸ‘‰ â€œUsers can read only their own profileâ€

### Policy logic (plain English):

* Allow SELECT
* If logged-in user ID == rowâ€™s user ID

ğŸ“Œ This is the **most common RLS policy** in Supabase apps.

---

## 7ï¸âƒ£ Insert Policy (Create Own Data)

Without an **INSERT policy**:

* Users cannot add data
* Even if logged in

ğŸ“Œ Insert rule idea:
ğŸ‘‰ â€œUser can insert data only with their own user IDâ€

This prevents:

* Creating rows for other users
* Data impersonation

---

## 8ï¸âƒ£ Update & Delete Policies

### Update policy

ğŸ‘‰ User can update **only their own rows**

### Delete policy

ğŸ‘‰ User can delete **only their own rows**

ğŸ“Œ Think of it like:

* You can edit or remove **your own file**
* Not someone elseâ€™s file

---

## 9ï¸âƒ£ Admin vs Normal User (Common Pattern)

Sometimes you need:

* Admin users â†’ full access
* Normal users â†’ limited access

ğŸ“Œ Common solution:

* Add a `role` column (e.g. `admin`, `user`)
* Write RLS rules based on role

Example logic (plain language):

* If role = admin â†’ allow everything
* Else â†’ allow only own rows

---

## ğŸ”Ÿ Testing RLS Safely

Always test:

* Logged-in user
* Logged-out user
* Different users

Supabase dashboard helps you:

* Simulate policies
* View errors clearly

ğŸ“Œ If data is not visible:

* It is **usually RLS**, not a bug

---

## 1ï¸âƒ£1ï¸âƒ£ Very Common Beginner Mistakes

âŒ Forgetting to enable RLS
âŒ Creating SELECT policy but not INSERT
âŒ Not linking table rows to user ID
âŒ Assuming anon key bypasses security

ğŸ‘‰ Remember:

> **Anon key respects RLS**
> **Service role key bypasses RLS**

---

## 1ï¸âƒ£2ï¸âƒ£ One Golden Rule (Memorize This)

> **No RLS policy = no data access**

This rule explains **90% of Supabase â€œerrorsâ€** beginners face.

---

## âœ… Key Takeaways (Must Remember)

* RLS is PostgreSQLâ€™s security system
* Supabase relies heavily on RLS
* Login alone does not give access
* Policies decide row-level permissions
* Secure by default = safer apps

---

### ğŸ”œ Chapter 9 Preview

Next chapter we will cover:

* Supabase auto-generated APIs
* REST endpoints
* How database tables become APIs
* Using Supabase without writing backend code


