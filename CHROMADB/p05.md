# **Chapter 5. CRUD Operations**

In any database system, **CRUD** (Create, Read, Update, Delete) operations are the backbone of data management. ChromaDB provides simple APIs to perform these operations directly on collections. Let’s explore each in detail.

---

## Insert Documents with `add()`

The `add()` method lets you insert new documents into a collection along with their embeddings, metadata, and IDs.

```python
import chromadb
from chromadb.utils import embedding_functions

# Initialize client and create a collection
client = chromadb.Client()
collection = client.create_collection(name="my_collection")

# Example embedding function (OpenAI or custom model can be used)
embedding_fn = embedding_functions.DefaultEmbeddingFunction()

# Adding documents
collection.add(
    documents=["ChromaDB is a vector database.", 
               "CRUD operations are essential in any DB."],
    metadatas=[{"topic": "database"}, {"topic": "CRUD"}],
    ids=["doc1", "doc2"]
)
```

✅ **Notes:**

* `documents`: list of text data.
* `metadatas`: list of dictionaries storing extra info (key-value).
* `ids`: unique identifiers for each document.

---

## Update Documents with `update()`

The `update()` method modifies documents, embeddings, or metadata for existing IDs.

```python
# Update a document by ID
collection.update(
    ids=["doc2"],
    documents=["CRUD stands for Create, Read, Update, Delete."],
    metadatas=[{"topic": "database-basics"}]
)
```

Here, `doc2` was updated with a new text and updated metadata.

⚠️ If the ID does not exist, `update()` will raise an error.

---

## Delete Documents with `delete()`

The `delete()` method removes documents based on IDs, metadata filters, or both.

```python
# Delete by ID
collection.delete(ids=["doc1"])

# Delete by metadata filter
collection.delete(where={"topic": "database-basics"})
```

* Passing `ids` removes specific documents.
* Passing `where` applies a metadata filter.
* You can also combine both for more precise deletion.

---

## Fetch Documents with `get()`

The `get()` method retrieves documents and their associated data by ID or filters.

```python
# Fetch by ID
result = collection.get(ids=["doc2"])
print(result)

# Fetch by metadata filter
result = collection.get(where={"topic": "CRUD"})
print(result)
```

Output structure includes:

* `ids`: List of document IDs.
* `documents`: Text content.
* `metadatas`: Attached metadata.
* `embeddings`: Vector embeddings (optional if `include=["embeddings"]`).

---

## Summary

* **`add()`** → Insert new documents.
* **`update()`** → Modify existing documents by ID.
* **`delete()`** → Remove documents by ID or filter.
* **`get()`** → Fetch documents by ID or filter.

With CRUD operations, you can fully manage the lifecycle of your documents in ChromaDB collections. These functions ensure your vector database remains accurate and up to date.

---

