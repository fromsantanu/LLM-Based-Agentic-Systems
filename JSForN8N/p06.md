# 🕒 6. **Date and Time Handling**

Working with **dates and times** is one of the most frequent tasks in n8n workflows — whether it’s timestamping data, calculating delays, or comparing events.

---

## 🧭 **Getting the Current Time**

Use the built-in JavaScript `Date` object.

```js
const now = new Date();
return [{ json: { now } }];
```

💡 To store the current timestamp in ISO format (great for databases or logs):

```js
const now = new Date();
$json.processedAt = now.toISOString();
return [{ json: $json }];
```

---

## 📅 **Formatting Dates**

Convert a date into a readable or required format:

```js
const now = new Date();
const formatted = now.toLocaleString("en-GB"); // e.g., "17/10/2025, 12:45:00"
return [{ json: { formatted } }];
```

✅ Common methods:

* `toISOString()` → `"2025-10-17T07:15:30.000Z"`
* `toDateString()` → `"Fri Oct 17 2025"`
* `toLocaleDateString()` → `"17/10/2025"`

---

## ➕ **Adding / Subtracting Days**

You can adjust time by changing milliseconds.

```js
const now = new Date();
const future = new Date(now);
future.setDate(now.getDate() + 7); // 7 days later

const past = new Date(now);
past.setDate(now.getDate() - 3); // 3 days earlier

return [{ json: { now, future, past } }];
```

---

## ⚖️ **Comparing Two Dates**

JavaScript lets you compare dates numerically.

```js
const start = new Date("2025-10-01");
const end = new Date("2025-10-17");

if (end > start) {
  $json.status = "valid";
} else {
  $json.status = "invalid";
}

return [{ json: $json }];
```

💡 Tip: You can get the **difference in days** like this:

```js
const diffMs = end - start; // milliseconds
const diffDays = diffMs / (1000 * 60 * 60 * 24);
return [{ json: { diffDays } }];
```

---

## 🕰️ **Mini Exercise**

1. Create a Function node that adds 30 days to a given date in `$json.dueDate`.
2. Return a new property `$json.nextCheckDate` with that new date.
3. Print both in ISO format.

---

✅ **Summary**

| Task                  | Method                              |
| --------------------- | ----------------------------------- |
| Get current date/time | `new Date()`                        |
| Format date           | `toISOString()`, `toLocaleString()` |
| Add/Subtract days     | `setDate(getDate() ± n)`            |
| Compare two dates     | `date1 > date2`                     |
| Difference in days    | `(date2 - date1) / (1000*60*60*24)` |

---
