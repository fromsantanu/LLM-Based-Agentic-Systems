
# ‚ö†Ô∏è 7. **Error Handling and Validation**

Keeping your workflow safe and predictable is **crucial** ‚Äî especially when dealing with medical or financial data where missing fields or failed API calls can cause serious issues.
In n8n Function nodes, you can handle and prevent errors using **try...catch**, validations, and logging.

---

## üß© **1. Using `try...catch` Blocks**

Wrap risky code in a `try...catch` block to prevent workflow crashes and handle errors gracefully.

```js
try {
  const patient = $json;
  if (!patient.id) throw new Error("Missing patient ID");

  // simulate risky operation
  const response = await fetch("https://api.example.com/patient", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(patient)
  });

  if (!response.ok) throw new Error("API request failed");
  const data = await response.json();
  return [{ json: data }];

} catch (error) {
  console.error("Error:", error.message);
  return [{ json: { status: "failed", error: error.message } }];
}
```

üí° **Why it matters:**
Without `try...catch`, any small issue (like a missing field or bad API response) could stop the entire workflow.

---

## üß© **2. Checking for Missing or Invalid Fields**

Always validate input data before processing. This is your first line of defense.

```js
const { patientName, age } = $json;

if (!patientName || typeof patientName !== "string") {
  throw new Error("Invalid or missing patientName");
}

if (!age || isNaN(age)) {
  throw new Error("Invalid or missing age");
}

return [{ json: { message: "Validation passed" } }];
```

üí° **Pro tip:** You can also use `$node["Previous Node"].json` to validate upstream data.

---

## üß© **3. Throwing Custom Errors**

Use `throw new Error("Your message")` to stop execution intentionally when something is wrong.

```js
if (!$json.email) {
  throw new Error("Patient email is required for notification.");
}
```

üí° **Why use custom errors:**
They make logs readable and help pinpoint exactly where validation failed.

---

## üß© **4. Logging for Debugging**

Use `console.log()` or `console.error()` to print information during workflow testing.

```js
console.log("Incoming data:", $json);
console.error("Something went wrong with:", $json.id);
```

üí° **Best practice:**
Remove or minimize logs before deploying to production to avoid clutter and data leaks.

---

## ‚úÖ **Mini Exercise**

1. Create a **Function node** that checks if:

   * `patientID` exists
   * `age` is greater than 0
   * `email` contains `"@"`

2. If all checks pass, return `"Validation successful"`.

3. If not, throw an error with a specific message.

---

Would you like me to include **Chapter 8: Logging and Debugging Tools in n8n** next (continuing from this one)?
