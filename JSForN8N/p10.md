# ⚙️ 10. **Putting It All Together**

Now that you’ve learned the core skills — JSON handling, arrays, APIs, async logic, and more — let’s put everything together into small **real-world practice projects** you can build *directly inside n8n Function nodes*.

Each of these projects focuses on combining multiple JavaScript concepts that are essential for automation design.

---

## 🩺 **1. Form Filter – Filter Emergency Cases from a Doctor’s Form**

**Goal:** Identify if a submitted form indicates an emergency case.

**Concepts Used:** JSON access, conditionals, arrays, logical operators, return filtering.

```js
// Input: array of form submissions
return items.filter(item => {
  const form = item.json;
  return (
    form.temperature > 103 ||
    form.bp_systolic > 160 ||
    form.symptoms.includes("chest pain") ||
    form.symptoms.includes("breathing difficulty")
  );
});
```

💡 **Usage:** Place this in a Function node after your form capture node — it outputs only *emergency cases* for further processing.

---

## ✉️ **2. Email Formatter – Prepare Structured Email Message**

**Goal:** Convert a patient’s form data into a clean, human-readable email.

**Concepts Used:** Template literals, string concatenation, JSON extraction.

```js
const p = $json;
const message = `
Subject: New Patient Form Received

Dear Dr. ${p.doctorName},

A new form has been submitted:

- Name: ${p.patientName}
- Age: ${p.age}
- Symptoms: ${p.symptoms.join(", ")}
- Urgency: ${p.urgency}

Regards,
n8n Automated System
`;

return [{ json: { emailMessage: message } }];
```

💡 **Usage:** Send the result to an **Email node** or external messaging system.

---

## 🌐 **3. API Bridge – Send Collected Data to an External Service**

**Goal:** Post processed data to another REST API endpoint.

**Concepts Used:** Async/await, fetch, JSON serialization, try...catch.

```js
const apiUrl = "https://api.example.com/patients";

try {
  const res = await fetch(apiUrl, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify($json)
  });
  const data = await res.json();
  return [{ json: data }];
} catch (err) {
  throw new Error("API call failed: " + err.message);
}
```

💡 **Usage:** Ideal for connecting n8n to your hospital database, CRM, or reporting API.

---

## 🔗 **4. Data Merger – Combine Lab Report Data with Patient Form**

**Goal:** Merge data from two sources — e.g., patient form + lab report.

**Concepts Used:** $node variable, object spread syntax, merging JSON.

```js
const form = $node["Patient Form"].json;
const lab = $node["Lab Report"].json;

const merged = { ...form, labResults: lab };
return [{ json: merged }];
```

💡 **Usage:** This combined record can then be used for decision-making, dashboard display, or report generation.

---

## 🕓 **5. Auto-Logger – Append Timestamps and Logs into Each Record**

**Goal:** Add processing time and log details automatically to each record.

**Concepts Used:** Date handling, mapping arrays, updating JSON.

```js
const now = new Date().toISOString();

return items.map(item => {
  item.json.processedAt = now;
  item.json.log = "Processed successfully by Auto-Logger";
  return item;
});
```

💡 **Usage:** Always useful before storing data in a database or sending it out.

---

## ✅ **Key Takeaway**

You can mix and match all these techniques in your n8n workflows:

| Concept           | Common Use                            |
| ----------------- | ------------------------------------- |
| JSON manipulation | Reading and transforming form data    |
| Array functions   | Filtering multiple records            |
| Async operations  | Calling APIs                          |
| Template literals | Generating messages                   |
| Merging objects   | Combining data sources                |
| Logging           | Tracking and debugging workflow state |

---

