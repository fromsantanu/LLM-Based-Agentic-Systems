## ⚙️ 2. **Working with JSON (Most Important for n8n)**

Because **all n8n data is JSON**, this is your *daily bread 🍞*.
Every node in n8n — whether it’s a Function, HTTP Request, or Set node — passes data as JSON objects inside an array of items.

---

### 🧩 **1. Understanding the n8n JSON Structure**

Each item flowing through n8n typically looks like this:

```js
{
  json: {
    name: "John Doe",
    age: 32,
    user: {
      address: {
        city: "London",
        country: "UK"
      }
    }
  },
  pairedItem: {}, // optional (used for references)
  binary: {} // optional (used for file data)
}
```

So inside a **Function** or **Code** node, you can access the data like:

```js
const name = item.json.name;
const city = item.json.user.address.city;
```

---

### 🧭 **2. Accessing JSON Properties**

```js
const name = item.json.name;
const age = item.json.age;
```

Nested properties:

```js
const city = item.json.user.address.city;
```

If you’re unsure if a nested key exists, use optional chaining:

```js
const city = item.json.user?.address?.city;
```

---

### ✏️ **3. Adding or Updating Properties**

To add or modify properties inside a JSON object:

```js
item.json.status = "processed";
item.json.updatedAt = new Date().toISOString();
```

Or you can return a **new updated object**:

```js
const updated = { ...item.json, status: "processed" };
return [{ json: updated }];
```

---

### 🧹 **4. Deleting Properties**

To remove an unwanted key:

```js
delete item.json.age;
```

---

### 🕵️‍♂️ **5. Checking if a Property Exists**

You can safely check for a key:

```js
if ("age" in item.json) {
  console.log("Age exists!");
}
```

or use optional chaining:

```js
if (item.json?.user?.address) {
  console.log("User address is present");
}
```

---

### 🔗 **6. Merging Two Objects**

When combining multiple JSON objects:

```js
const obj1 = { name: "John", age: 32 };
const obj2 = { city: "London", country: "UK" };

const merged = { ...obj1, ...obj2 };
return [{ json: merged }];
```

---

### 🧬 **7. Cloning Objects Safely**

If you modify an object directly, you might change the original reference.
To create a **safe copy**:

```js
const clone = JSON.parse(JSON.stringify(item.json));
clone.status = "copied";
return [{ json: clone }];
```

---

### 💡 **8. Example in n8n Code Node**

```js
// Get the incoming JSON
const name = $json.name;

// Update data with new property
const updated = {
  ...$json,
  status: "processed",
  updatedAt: new Date().toISOString()
};

// Return the modified item
return [{ json: updated }];
```

---

### 🧠 **Mini Exercise**

Try this in an n8n **Function** node:

1. Add an input item with JSON:

   ```json
   { "user": { "name": "Alice", "age": 25 }, "country": "India" }
   ```
2. Add a new field `"verified": true`.
3. Remove `"age"`.
4. Merge it with `{ "role": "student" }`.
5. Return the final JSON.

✅ Expected Output:

```json
{
  "user": { "name": "Alice" },
  "country": "India",
  "verified": true,
  "role": "student"
}
```

---
