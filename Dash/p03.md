# **Chapter 3: Callbacks â€“ Making Apps Interactive**

Dash becomes truly powerful when your app responds to user input â€” such as changing a dropdown, clicking a button, or typing in a text field.
This is achieved using **callbacks**.

---

## **3.1 What is a Callback?**

A **callback** in Dash connects user inputs (like dropdowns, sliders, checkboxes) to outputs (like charts, text, or tables).

* **User interacts with Input â†’ Dash calls a Python function â†’ Output updates automatically.**

Callbacks make your app **reactive** â€” meaning, the interface updates dynamically when inputs change.

---

## **3.2 The @app.callback Decorator Explained**

Dash uses the `@app.callback()` decorator to define the relationship between:

* **Input(s):** Component property that triggers the update.
* **Output(s):** Component property that gets updated.
* **State(s):** Component property that is passed into the function but does not trigger the callback.

**Syntax:**

```python
@app.callback(
    Output(component_id, component_property),
    Input(component_id, component_property),
    State(component_id, component_property)
)
def function_name(input_value, state_value):
    return output_value
```

* **Output:** Defines which component & property gets updated.
* **Input:** Defines which component & property triggers the callback.
* **State (optional):** Provides extra data but does not trigger the callback.

---

## **3.3 Example: Update a Graph Dynamically Based on Dropdown Selection**

Letâ€™s build a small app that updates a **line chart** dynamically based on a **dropdown menu selection**.

### **Complete Example:**

```python
# app3_callbacks.py
import dash
from dash import dcc, html, Input, Output
import plotly.express as px
import pandas as pd

# Sample Data
df = px.data.gapminder()

# Initialize the Dash app
app = dash.Dash(__name__)

# Layout
app.layout = html.Div([
    html.H1("Interactive Graph Example", style={'textAlign': 'center'}),
    
    html.Label("Select a Country:"),
    dcc.Dropdown(
        id='country-dropdown',
        options=[{'label': c, 'value': c} for c in df['country'].unique()],
        value='India',  # default selection
        style={'width': '50%'}
    ),
    
    dcc.Graph(id='country-graph')
])

# Callback to update the graph
@app.callback(
    Output('country-graph', 'figure'),
    Input('country-dropdown', 'value')
)
def update_graph(selected_country):
    filtered_df = df[df['country'] == selected_country]
    fig = px.line(
        filtered_df, 
        x='year', 
        y='gdpPercap', 
        title=f"GDP per Capita of {selected_country} Over Time"
    )
    return fig

# Run the app
if __name__ == '__main__':
    app.run_server(debug=True)
```

---

### **Explanation:**

1. **Dropdown Component (`dcc.Dropdown`):**

   * Lets the user select a country.
   * The selected value is passed into the callback as input.

2. **Callback Function (`update_graph`):**

   * Takes the selected country value as input.
   * Filters the data accordingly.
   * Returns a new figure to update the `dcc.Graph`.

3. **Output (`Output('country-graph', 'figure')`):**

   * Updates the `figure` property of the Graph component whenever the dropdown selection changes.

---

### **3.4 Adding Multiple Inputs**

You can use **multiple inputs** in the same callback.
For example, selecting a **country** and a **metric** (like GDP or life expectancy):

```python
@app.callback(
    Output('country-graph', 'figure'),
    Input('country-dropdown', 'value'),
    Input('metric-dropdown', 'value')
)
def update_graph(selected_country, selected_metric):
    filtered_df = df[df['country'] == selected_country]
    fig = px.line(filtered_df, x='year', y=selected_metric,
                  title=f"{selected_metric} of {selected_country} Over Time")
    return fig
```

---

### **3.5 Adding State**

`State` can be used when you donâ€™t want the callback to trigger automatically.
For example, you can have a **Submit** button that updates the graph only when clicked.

```python
@app.callback(
    Output('country-graph', 'figure'),
    Input('submit-button', 'n_clicks'),
    State('country-dropdown', 'value')
)
def update_on_submit(n_clicks, selected_country):
    filtered_df = df[df['country'] == selected_country]
    fig = px.line(filtered_df, x='year', y='lifeExp',
                  title=f"Life Expectancy of {selected_country} Over Time")
    return fig
```

---

### **3.6 Key Points to Remember**

| Concept         | Description                                               |
| --------------- | --------------------------------------------------------- |
| **Input**       | Triggers the callback when its property changes           |
| **Output**      | The component property that gets updated                  |
| **State**       | Provides data to the callback but doesnâ€™t trigger it      |
| **Decorator**   | Connects Dash components and the Python function          |
| **Reactive UI** | Dash automatically updates outputs based on input changes |

---

### âœ… **Summary**

* Callbacks are the heart of Dash interactivity.
* They connect input components (like dropdowns) to outputs (like graphs).
* `@app.callback()` is used to define these relationships.
* You can have multiple inputs and outputs, and even control when updates occur using **State**.

---

### ðŸ”¹ **Next Chapter Preview:**

**Chapter 4: Advanced Callback Patterns**

* Chained callbacks
* Multiple outputs
* Preventing updates
* Circular callback resolution

---
