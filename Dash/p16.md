# Chapter 16 — Theming & Styling in Dash

## What you’ll learn

* The 3 common ways to style Dash apps (inline props, CSS classes, component libraries)
* Adding **external CSS**: Bootstrap and Tailwind
* Working with **`dcc.Tabs`**, **cards**, grid/layout helpers
* A complete **“Modern Healthcare Dashboard”** example using Bootstrap components

---

## 1) Styling in Dash: the big picture

1. **Inline style props** (quick tweaks)

```python
html.Div("Hello", style={"padding":"8px", "color":"#0f766e"})
```

2. **CSS classes** (scalable)
   Put a file in `assets/` (e.g., `assets/app.css`), then:

```python
html.Div("Hello", className="headline")
```

3. **Component libraries** (fast, consistent UI)
   Use **dash-bootstrap-components (dbc)** for Bootstrap themes, grids, and cards.

---

## 2) Using External CSS

### Option A — Bootstrap (recommended for Dash)

**Why:** prebuilt components, grid utilities, 20+ themes.

**Install**

```bash
pip install dash-bootstrap-components
```

**Use a theme**

```python
import dash
import dash_bootstrap_components as dbc

app = dash.Dash(__name__, external_stylesheets=[dbc.themes.BOOTSTRAP])  # try CYBORG, LUX, MINTY, MORPH
```

> Tip: Pair with **`dbc.icons.BOOTSTRAP`** for icons:

```python
app = dash.Dash(
    __name__,
    external_stylesheets=[dbc.themes.MINTY, dbc.icons.BOOTSTRAP]
)
```

### Option B — Tailwind CSS

**Why:** utility-first classes and rapid custom design.

**Simplest path (CDN, dev/demo only):**
Create `assets/tailwind.html` with:

```html
<!-- This file just ensures the CDN gets loaded by Dash (any .html in assets is injected) -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: { extend: { colors: { brand: '#0f766e' } } }
  }
</script>
```

Then use utility classes:

```python
html.Div([
    html.H2("Tailwind Box", className="text-xl font-semibold text-brand"),
    html.P("This is styled with Tailwind.", className="text-slate-600")
], className="p-4 rounded-xl shadow")
```

> **Production note:** Prefer a build step (e.g., `tailwindcss -i ./input.css -o ./assets/tailwind.css --minify`) so you ship a single minified CSS instead of the CDN runtime.

---

## 3) Tabs, Cards & Layout Helpers

### `dcc.Tabs` and `dcc.Tab`

```python
import dash
from dash import html, dcc, Output, Input

app = dash.Dash(__name__)

app.layout = html.Div([
    dcc.Tabs(id="tabs", value="tab-1", children=[
        dcc.Tab(label="Overview", value="tab-1"),
        dcc.Tab(label="Patients", value="tab-2"),
        dcc.Tab(label="Trends", value="tab-3"),
    ]),
    html.Div(id="tab-content", className="p-3")
])

@app.callback(Output("tab-content", "children"), Input("tabs", "value"))
def render_tab(tab):
    if tab == "tab-1":
        return html.P("KPIs and highlights…")
    if tab == "tab-2":
        return html.P("Patient table goes here…")
    return html.P("Time-series trends…")

if __name__ == "__main__":
    app.run_server(debug=True)
```

### Bootstrap Cards & Grid (with `dash-bootstrap-components`)

```python
import dash_bootstrap_components as dbc
from dash import html

card = dbc.Card(
    dbc.CardBody([
        html.H5("Admissions (24h)", className="card-title"),
        html.H2("128"),
        html.Small("vs. 116 yesterday", className="text-muted")
    ]),
    className="shadow-sm"
)

row_of_cards = dbc.Row([
    dbc.Col(card, md=3),
    dbc.Col(card, md=3),
    dbc.Col(card, md=3),
    dbc.Col(card, md=3),
], className="g-3")  # g-3 adds gutter spacing
```

> Useful Bootstrap classes:

* Spacing: `p-3`, `pt-2`, `mx-2`
* Flex: `d-flex`, `align-items-center`, `justify-content-between`
* Colors: `text-success`, `bg-light`, `border-0`
* Grid: `Row` + `Col` with `md=`, `lg=`, `xl=`

---

## 4) Theme Switching (Bonus)

Let users pick a theme dynamically:

```python
import dash
import dash_bootstrap_components as dbc
from dash import html, dcc, Output, Input

THEMES = {
    "Minty": dbc.themes.MINTY,
    "Cyborg (Dark)": dbc.themes.CYBORG,
    "Morph": dbc.themes.MORPH,
    "Flatly": dbc.themes.FLATLY,
}

app = dash.Dash(__name__, external_stylesheets=[list(THEMES.values())[0]])

app.layout = html.Div([
    dbc.Row([
        dbc.Col(html.H3("Theme switcher"), md=6),
        dbc.Col(dcc.Dropdown(
            id="theme-dd",
            options=[{"label": k, "value": v} for k, v in THEMES.items()],
            value=dbc.themes.MINTY,
            clearable=False
        ), md=6)
    ], className="g-2 p-3"),
    html.Link(id="theme-css"),  # will swap the href dynamically
    dbc.Alert("Try switching themes!", color="info", className="m-3"),
])

@app.callback(Output("theme-css", "href"), Input("theme-dd", "value"))
def swap_theme(href):
    return href  # Dash will load the selected CDN CSS

if __name__ == "__main__":
    app.run_server(debug=True)
```

---

## 5) Example — Modern Healthcare Dashboard (Bootstrap)

**What it shows**

* Navbar with brand & right-side controls
* KPI cards row
* Tabs: Overview / Patients / Resources
* Plotly chart area
* Clean, themeable Bootstrap layout

```python
import dash
from dash import html, dcc, Input, Output
import dash_bootstrap_components as dbc
import plotly.express as px
import pandas as pd
import numpy as np

# --------- Fake data ----------
np.random.seed(7)
days = pd.date_range("2025-09-01", periods=30)
admissions = (50 + np.random.randint(-8, 12, size=30)).cumsum()
icu_load = (30 + np.random.randint(-5, 6, size=30)).clip(10, 60)
df = pd.DataFrame({"date": days, "admissions": admissions, "icu": icu_load})

# --------- App ----------
app = dash.Dash(
    __name__,
    external_stylesheets=[dbc.themes.MINTY, dbc.icons.BOOTSTRAP],
    title="Healthcare Ops"
)

# Navbar
navbar = dbc.Navbar(
    dbc.Container([
        dbc.NavbarBrand([html.I(className="bi bi-heart-pulse me-2"), "CareOps Dashboard"], className="fw-semibold"),
        dbc.Nav([
            dbc.NavItem(dbc.NavLink("Home", href="#")),
            dbc.NavItem(dbc.NavLink("Reports", href="#")),
            dbc.DropdownMenu(
                label="More",
                children=[dbc.DropdownMenuItem("Settings"), dbc.DropdownMenuItem("Help")],
                nav=True, in_navbar=True
            ),
        ], className="ms-auto", navbar=True)
    ]),
    dark=False, color="white", className="shadow-sm"
)

# KPI Card helper
def kpi(title, value, sub):
    return dbc.Card(
        dbc.CardBody([
            html.Div(title, className="text-muted small"),
            html.Div(value, className="h3 mb-0"),
            html.Div(sub, className="small text-secondary")
        ]),
        className="shadow-sm h-100"
    )

kpis = dbc.Row([
    dbc.Col(kpi("Admissions (24h)", "128", "↑ 10.3% vs. prev day"), md=3),
    dbc.Col(kpi("ICU Occupancy", "62%", "Stable"), md=3),
    dbc.Col(kpi("Avg. Wait Time", "14 min", "ED triage"), md=3),
    dbc.Col(kpi("Discharges (24h)", "97", "↑ 4.2% vs. prev day"), md=3),
], className="g-3")

# Tabs
tabs = dcc.Tabs(id="tabs", value="overview", children=[
    dcc.Tab(label="Overview", value="overview"),
    dcc.Tab(label="Patients", value="patients"),
    dcc.Tab(label="Resources", value="resources"),
])

# Content area
overview_content = dbc.Row([
    dbc.Col(dbc.Card(dbc.CardBody([
        html.H5("Admissions Trend", className="card-title"),
        dcc.Graph(
            id="admissions-chart",
            figure=px.line(df, x="date", y="admissions", markers=True)
                   .update_layout(margin=dict(l=20, r=20, t=20, b=20))
        )
    ]), className="shadow-sm"), md=8),

    dbc.Col(dbc.Card(dbc.CardBody([
        html.H5("ICU Load (Last 30 days)", className="card-title"),
        dcc.Graph(
            id="icu-chart",
            figure=px.area(df, x="date", y="icu")
                   .update_layout(margin=dict(l=20, r=20, t=20, b=20))
        )
    ]), className="shadow-sm"), md=4),
], className="g-3")

patients_table = dbc.Card(dbc.CardBody([
    html.H5("Today’s Admissions", className="card-title"),
    dbc.Table([
        html.Thead(html.Tr([html.Th("MRN"), html.Th("Name"), html.Th("Dept"), html.Th("Status")])),
        html.Tbody([
            html.Tr([html.Td("A1209"), html.Td("Roy, A."), html.Td("Cardiology"), html.Td("In ED")]),
            html.Tr([html.Td("B0311"), html.Td("Khan, R."), html.Td("Orthopedics"), html.Td("Admitted")]),
            html.Tr([html.Td("M4920"), html.Td("Iyer, S."), html.Td("Neurology"), html.Td("In ED")]),
            html.Tr([html.Td("Z2104"), html.Td("Das, P."), html.Td("General Med"), html.Td("Discharged")]),
        ])
    ], bordered=False, hover=True, responsive=True, className="mb-0")
]), className="shadow-sm")

resources_cards = dbc.Row([
    dbc.Col(dbc.Card(dbc.CardBody([
        html.Div("Ventilators", className="text-muted small"),
        html.Div("28 / 40 in use", className="h5 mb-0"),
        html.Div("Capacity OK", className="small text-success")
    ]), className="shadow-sm"), md=4),
    dbc.Col(dbc.Card(dbc.CardBody([
        html.Div("Beds (ICU)", className="text-muted small"),
        html.Div("31 / 50 occupied", className="h5 mb-0"),
        html.Div("Watch high load", className="small text-warning")
    ]), className="shadow-sm"), md=4),
    dbc.Col(dbc.Card(dbc.CardBody([
        html.Div("Staff On Duty", className="text-muted small"),
        html.Div("136 clinicians", className="h5 mb-0"),
        html.Div("Shifts balanced", className="small text-secondary")
    ]), className="shadow-sm"), md=4),
], className="g-3")

content = html.Div(id="tab-content", className="mt-3")

app.layout = dbc.Container([
    navbar,
    html.Div(className="py-3"),
    kpis,
    html.Div(className="py-2"),
    tabs,
    content,
    html.Footer(
        dbc.Container([
            html.Hr(),
            html.Small("© 2025 CareOps • Built with Dash + Bootstrap")
        ], className="text-muted py-3")
    )
], fluid=True)

@app.callback(Output("tab-content", "children"), Input("tabs", "value"))
def render_tab(value):
    if value == "overview":
        return overview_content
    if value == "patients":
        return patients_table
    return resources_cards

if __name__ == "__main__":
    app.run_server(debug=True)
```

---

## 6) Tips & gotchas

* **`assets/` priority:** Files load alphabetically; use names like `00_theme.css` then `10_overrides.css`.
* **Conflicts:** Don’t mix heavy Tailwind and Bootstrap on the same page unless you scope classes carefully.
* **Responsive layout:** Use Bootstrap `Row/Col` and `%`/`vw` widths; avoid fixed pixel widths in charts.
* **Dark themes:** Try `dbc.themes.CYBORG` and ensure text/axes colors in Plotly adapt (set template or colorway if needed).
* **Reusability:** Wrap card/KPI builders into functions to standardize look & feel.

---

## 7) Mini checklist

* [ ] Pick a theme (Bootstrap or Tailwind)
* [ ] Centralize custom variables in `assets/_tokens.css`
* [ ] Build with `Row/Col`, Cards, and `dcc.Tabs`
* [ ] Test on mobile widths (≤ 420px)
* [ ] Keep Plotly margins tight for denser dashboards

---
