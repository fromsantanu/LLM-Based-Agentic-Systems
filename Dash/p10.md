# üß© Chapter 10: Storing Data in Dash

### üéØ Objective

Learn how to store, share, and restore user data across callbacks and sessions in Dash using `dcc.Store`. You‚Äôll understand the differences between temporary and persistent storage and apply them to remember user selections.

---

## 10.1 Understanding `dcc.Store`

The `dcc.Store` component in Dash is used to **store data on the client side** (browser).
It helps share intermediate data between callbacks **without saving to a database**.

### ‚úÖ Key Uses:

* Cache processed data between callbacks
* Retain user preferences (filters, chart type, etc.)
* Share data between pages in a multi-page app

---

## 10.2 Structure and Properties

```python
dcc.Store(
    id='memory-store',
    storage_type='memory',  # 'memory', 'local', or 'session'
    data=None
)
```

### ‚öôÔ∏è Parameters

| Parameter      | Description                                                 |
| -------------- | ----------------------------------------------------------- |
| `id`           | Unique identifier of the storage component                  |
| `storage_type` | Type of browser storage used (`memory`, `local`, `session`) |
| `data`         | The JSON-serializable object to store                       |

---

## 10.3 Storage Types

| Storage Type | Description                                        | Lifespan                         |
| ------------ | -------------------------------------------------- | -------------------------------- |
| `memory`     | Default option, data exists while the page is open | Lost on page refresh             |
| `local`      | Data stored in the browser‚Äôs local storage         | Persists across browser sessions |
| `session`    | Data stored in session storage                     | Lost when browser tab is closed  |

---

## 10.4 Example: Save User-Selected Filters and Restore Them

Let‚Äôs create a simple **filter app** that remembers the user‚Äôs selected country, even after page reloads (using `local` storage).

### üß† Concept:

1. User selects a country from a dropdown.
2. The selection is stored in `dcc.Store`.
3. When the page reloads, the stored value is restored automatically.

---

### üß© Code Example

```python
import dash
from dash import dcc, html, Input, Output

app = dash.Dash(__name__)

app.layout = html.Div([
    html.H2("üåç Country Selection with Saved State"),

    # Store Component
    dcc.Store(id='stored-country', storage_type='local'),

    # Dropdown
    dcc.Dropdown(
        id='country-dropdown',
        options=[
            {'label': 'India', 'value': 'India'},
            {'label': 'USA', 'value': 'USA'},
            {'label': 'Japan', 'value': 'Japan'},
            {'label': 'Brazil', 'value': 'Brazil'}
        ],
        placeholder="Select a country"
    ),

    html.Br(),
    html.Div(id='output-display')
])

# Save the selected country into Store
@app.callback(
    Output('stored-country', 'data'),
    Input('country-dropdown', 'value')
)
def save_selection(selected_country):
    if selected_country:
        return {'country': selected_country}
    return dash.no_update


# Load the stored value when page refreshes
@app.callback(
    Output('country-dropdown', 'value'),
    Input('stored-country', 'data')
)
def load_selection(stored_data):
    if stored_data is not None:
        return stored_data.get('country')
    return None


# Display the current selection
@app.callback(
    Output('output-display', 'children'),
    Input('country-dropdown', 'value')
)
def display_output(country):
    if country:
        return f"You selected: {country}"
    return "Please select a country."


if __name__ == '__main__':
    app.run_server(debug=True)
```

---

## 10.5 How It Works

1. **User selects a country** ‚Üí triggers the first callback ‚Üí stores selection in `dcc.Store`.
2. **On page reload**, the stored data is reloaded (because storage type is `local`).
3. **Dropdown pre-fills** with the stored value automatically.
4. The third callback updates the display text.

---

## 10.6 When to Use `dcc.Store`

| Use Case                          | Recommended Type |
| --------------------------------- | ---------------- |
| Temporary in-page data            | `memory`         |
| Retain filters after page reload  | `local`          |
| Maintain data during session tabs | `session`        |

---

## 10.7 Summary

| Concept                                | Key Idea                                |
| -------------------------------------- | --------------------------------------- |
| `dcc.Store`                            | Used for client-side storage            |
| `storage_type='local'`                 | Data persists after reload              |
| Sharing data between callbacks         | Avoids recomputation and improves speed |
| Ideal for dashboards with user filters | Enhances user experience                |

---

## üß© Exercise

**Task:**
Modify the example to store **two filters** ‚Äî Country and Year (Dropdowns).
Display both selected values even after refreshing the page.

---

