# Chapter 2 — Dash App Layout

This chapter shows how Dash turns **Python objects into a webpage layout**. You’ll learn the `app.layout` concept, when to use `dash.html` vs `dash.dcc`, and a few practical patterns for building rows/columns—ending with a clean two-column example (text left, graph right).

---

## 2.1 The `app.layout` concept

* **What it is:** A **tree of Dash components** that describes what the browser should render.
* **What it contains:** Only components (from `dash.html`, `dash.dcc`, or other component libraries). No plain strings or numbers unless wrapped in a component (e.g., `html.P("Hello")`).
* **When it’s set:** Usually once, as `app.layout = ...`. For advanced cases (multi-page apps, per-session state), you can set `app.layout` to a **function** that returns the layout tree.

### Minimal skeleton

```python
from dash import Dash, html

app = Dash(__name__)
app.layout = html.Div([
    html.H1("My First Layout"),
    html.P("Everything you see is a Dash component.")
])

if __name__ == "__main__":
    app.run(debug=True)
```

### Layout as a function (advanced pattern)

```python
from dash import Dash, html
import datetime as dt

app = Dash(__name__)

def serve_layout():
    return html.Div([
        html.H4("Dynamic layout"),
        html.P(f"Rendered at: {dt.datetime.now():%H:%M:%S}")
    ])

app.layout = serve_layout  # note: no parentheses

if __name__ == "__main__":
    app.run(debug=True)
```

---

## 2.2 Using HTML components (`dash.html`)

`dash.html` mirrors standard HTML tags (div, h1, p, img, etc.) as Python classes.

* **Common pattern:** `html.TagName(children=..., id=..., className=..., style={...})`
* **Styling:**

  * Quick styles: inline `style={...}` (a Python dict using **camelCase** CSS keys, e.g., `backgroundColor`).
  * Reusable styles: external CSS files (recommended as apps grow).

### Examples

```python
from dash import html

html.Div([
    html.H2("Title"),
    html.P("Paragraph with a "),
    html.A("link", href="https://plotly.com/dash/"),
], style={"padding": "1rem", "border": "1px solid #eee", "borderRadius": "12px"})
```

---

## 2.3 Using Core components (`dash.dcc`)

`dash.dcc` (Dash Core Components) provides **interactive widgets**: graphs, dropdowns, sliders, inputs, date pickers, etc. These are **React components** wrapped for Python.

* **Graphing:** `dcc.Graph(figure=...)` renders Plotly figures.
* **Inputs:** `dcc.Dropdown`, `dcc.Slider`, `dcc.Input`, etc.
* **Stateful UI:** Each interactive component needs a unique `id` if it will participate in callbacks.

### Examples

```python
from dash import dcc
import plotly.express as px

fig = px.line(
    x=[1,2,3,4], y=[10,5,8,12],
    labels={"x": "Quarter", "y": "Revenue"}
)

dcc.Graph(id="revenue-chart", figure=fig)
```

---

## 2.4 Structuring layout with **Div, Row, Column**

Dash doesn’t ship “Row/Col” abstractions in core, but you can get the same effect with **CSS**:

### A) Pure Dash (Flexbox) — no extra libraries

Use nested `html.Div` and CSS Flexbox.

```python
from dash import html

# A row: children placed side-by-side
row = html.Div(
    [
        html.Div("Left pane", style={"flex": "1", "padding": "1rem"}),
        html.Div("Right pane", style={"flex": "2", "padding": "1rem"}),
    ],
    style={"display": "flex", "gap": "1rem"}
)

# A column: children stacked vertically (default)
column = html.Div(
    [
        html.Div("Top", style={"padding": "0.5rem"}),
        html.Div("Bottom", style={"padding": "0.5rem"}),
    ],
    # display:block is default; shown for clarity
)
```

**Tips**

* `style={"display": "flex"}` makes a row.
* Use each child’s `style={"flex": "1"}` to control widths (1:2:1, etc.).
* Add `flexWrap: "wrap"` for mobile-friendly wrapping.

### B) (Optional) With `dash-bootstrap-components` (dbc)

If you prefer a grid system:

```bash
pip install dash-bootstrap-components
```

```python
import dash_bootstrap_components as dbc
from dash import Dash, html

app = Dash(__name__, external_stylesheets=[dbc.themes.BOOTSTRAP])

app.layout = dbc.Container([
    dbc.Row([
        dbc.Col(html.Div("Left"), width=4),
        dbc.Col(html.Div("Right"), width=8),
    ])
], fluid=True)
```

> This chapter proceeds with **pure Dash + Flexbox** to keep dependencies minimal.

---

## 2.5 Example — Two-column layout (text left, graph right)

A complete, runnable file:

```python
# file: chapter2_two_column.py
from dash import Dash, html, dcc
import plotly.express as px

app = Dash(__name__)

# 1) Build a simple figure
df = px.data.gapminder().query("year == 2007")
fig = px.scatter(
    df,
    x="gdpPercap",
    y="lifeExp",
    size="pop",
    color="continent",
    hover_name="country",
    title="Life Expectancy vs GDP per Capita (2007)"
)

# 2) Compose the layout as a 2-column Flexbox row
app.layout = html.Div(
    [
        html.H1("Dash Layout: Two Columns", style={"marginBottom": "0.5rem"}),

        html.Div(
            [
                # Left column (text)
                html.Div(
                    [
                        html.H3("About this chart"),
                        html.P(
                            "This scatter plot shows the relation between GDP per capita "
                            "and life expectancy for countries in 2007. Bubble size "
                            "represents population; color encodes continent."
                        ),
                        html.Ul([
                            html.Li("Hover to see country details"),
                            html.Li("Pan/zoom with the toolbar inside the chart"),
                            html.Li("Reset view with the home icon")
                        ]),
                    ],
                    style={
                        "flex": "1",
                        "padding": "1rem",
                        "backgroundColor": "#fafafa",
                        "border": "1px solid #eee",
                        "borderRadius": "12px",
                        "minWidth": "260px"
                    },
                ),

                # Right column (graph)
                html.Div(
                    [
                        dcc.Graph(id="main-graph", figure=fig, style={"height": "70vh"})
                    ],
                    style={
                        "flex": "2",
                        "padding": "1rem",
                        "border": "1px solid #eee",
                        "borderRadius": "12px",
                        "overflow": "hidden",
                        "minWidth": "300px"
                    },
                ),
            ],
            style={
                "display": "flex",
                "gap": "1rem",
                "alignItems": "stretch",
                "flexWrap": "wrap"   # wraps on small screens
            },
        ),
    ],
    style={"padding": "1rem 1.25rem 2rem"}
)

if __name__ == "__main__":
    app.run(debug=True)
```

### What to notice

* The **row** is the outer `html.Div` with `display:flex`.
* The **columns** are just child `html.Div`s with different `flex` ratios (`1` vs `2`).
* `flexWrap:"wrap"` makes the layout responsive (stacks on narrow screens).
* `minWidth` prevents columns from getting too skinny on mobile.

---

## 2.6 Practical patterns & tips

* **IDs early:** Give meaningful `id`s to components you’ll use in callbacks later.
* **Avoid deep nesting:** Prefer few levels with Flexbox instead of many nested `Div`s.
* **Reusable styles:** Extract common style dicts (e.g., `CARD = {...}`) to keep code tidy.
* **External CSS:** For larger projects, add a `assets/` folder with `.css` files for global styling.
* **Spacing:** Use `gap` on Flex containers; it’s cleaner than manual margins.

---

## 2.7 Quick exercises

1. **Three columns:** Extend the example to add a **third** column showing a `dcc.Dropdown` to filter continents (the callback will come in a later chapter).
2. **Stacked sections:** Convert the left column into two stacked cards (overview + “how to read the chart”).
3. **Responsive tweak:** Change `flex` values based on screen size (try a media query in an external CSS file).

---

